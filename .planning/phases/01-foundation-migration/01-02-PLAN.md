---
phase: 01-foundation-migration
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - src/main.tsx
  - src/App.tsx
  - src/contexts/Global.tsx
  - src/screens/Home.tsx
  - src/screens/Windows.tsx
  - src/screens/QuestionPicker.tsx
  - src/screens/Question.tsx
  - src/screens/Rate.tsx
  - src/screens/Set.tsx
  - src/components/Score.tsx
  - src/components/IconButton.tsx
autonomous: true

must_haves:
  truths:
    - "All source files are .tsx with no .js files remaining in src/"
    - "npm run dev starts without TypeScript compilation errors"
    - "npm run build succeeds with tsc type checking"
  artifacts:
    - path: "src/App.tsx"
      provides: "Main app component with typed props"
      min_lines: 40
    - path: "src/contexts/Global.tsx"
      provides: "Typed context with state interfaces"
      contains: "interface"
    - path: "src/screens/Question.tsx"
      provides: "Largest screen component, fully typed"
      min_lines: 100
  key_links:
    - from: "src/main.tsx"
      to: "src/App.tsx"
      via: "import statement"
      pattern: "import App from"
    - from: "src/App.tsx"
      to: "src/contexts/Global.tsx"
      via: "useGlobalContext hook"
      pattern: "useGlobalContext"
---

<objective>
Convert all JavaScript files to TypeScript with full type safety and noImplicitAny compliance.

Purpose: Establish type safety across the entire codebase as per ARCH-01 (no JavaScript). The codebase is small (~12 files) so big-bang conversion is feasible per user decision.
Output: Fully typed TypeScript codebase with zero type errors, ready for Zustand migration.
</objective>

<execution_context>
@/Users/jweaker/.config/opencode/get-shit-done/workflows/execute-plan.md
@/Users/jweaker/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/01-foundation-migration/01-CONTEXT.md
@.planning/phases/01-foundation-migration/01-01-SUMMARY.md

# Files to convert
@src/App.js
@src/contexts/Global.js
@src/screens/Home.js
@src/screens/Question.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Convert core files and contexts to TypeScript</name>
  <files>
    src/main.tsx
    src/App.tsx
    src/contexts/Global.tsx
    src/contexts/index.ts
  </files>
  <action>
1. Convert src/main.tsx (already renamed in Plan 01):
   - Add proper type for root element: `document.getElementById("root") as HTMLElement`
   - Remove any implicit any types
   - Keep the same structure but with TypeScript

2. Convert src/App.js to src/App.tsx:
   - Add proper types for keyboard event handler: `(e: KeyboardEvent) => void`
   - Type the useState for hideCursor: `useState<boolean>(false)`
   - Delete the .js file after conversion

3. Convert src/contexts/Global.js to src/contexts/Global.tsx:
   - Create interfaces for the context value:
     ```ts
     interface GlobalContextValue {
       rightScore: number;
       setRightScore: React.Dispatch<React.SetStateAction<number>>;
       leftScore: number;
       setLeftScore: React.Dispatch<React.SetStateAction<number>>;
       rightsTurn: boolean;
       setRightsTurn: React.Dispatch<React.SetStateAction<boolean>>;
       quickQuestion: number;
       setQuickQuestion: React.Dispatch<React.SetStateAction<number>>;
       audienceQuestion: number;
       setAudienceQuestion: React.Dispatch<React.SetStateAction<number>>;
       turned: boolean;
       setTurned: React.Dispatch<React.SetStateAction<boolean>>;
       DATA: EpisodeData;
       setDATA: React.Dispatch<React.SetStateAction<EpisodeData>>;
     }
     ```
   - Create type for episode data based on the JSON structure (can be loose for now, refined later):
     ```ts
     interface EpisodeData {
       teams: { right: string; left: string };
       [key: string]: unknown; // Allow other properties for now
     }
     ```
   - Type the createContext with the interface
   - Delete the .js file after conversion

4. Convert src/contexts/index.js to src/contexts/index.ts:
   - Simple re-export, just rename
  </action>
  <verify>
    - `npx tsc --noEmit` on converted files shows no errors for these 4 files
    - `npm run dev` starts and app still renders
  </verify>
  <done>
    - main.tsx, App.tsx, Global.tsx fully typed
    - No .js files remain in src/ root or contexts/
    - Context provides typed values
  </done>
</task>

<task type="auto">
  <name>Task 2: Convert all screens to TypeScript</name>
  <files>
    src/screens/Home.tsx
    src/screens/Windows.tsx
    src/screens/QuestionPicker.tsx
    src/screens/Question.tsx
    src/screens/Rate.tsx
    src/screens/Set.tsx
  </files>
  <action>
1. For each screen file, rename .js to .tsx and add types:

   **Home.tsx:**
   - Type any keyboard handlers
   - Type navigation with useNavigate
   - Type any props if present

   **Windows.tsx:**
   - Type the window/category data structures
   - Type click handlers

   **QuestionPicker.tsx:**
   - Type useParams(): `{ id: string }`
   - Type the question selection logic

   **Question.tsx (largest file, ~414 lines):**
   - Type useParams(): `{ type: string; id?: string; index?: string }`
   - Type the question/answer data structures
   - Type event handlers for keyboard interaction
   - Type any timers or state

   **Rate.tsx:**
   - Type the rating/scoring logic
   - Type useParams

   **Set.tsx:**
   - Type any settings/configuration state

2. For each file:
   - Rename .js to .tsx
   - Add explicit types to function parameters
   - Type useState hooks with generics
   - Type event handlers (React.MouseEvent, KeyboardEvent, etc.)
   - Delete the .js file

3. Import patterns:
   - Use `import type { ... }` for type-only imports where appropriate
   - Ensure all react-router-dom hooks are properly typed

4. Handle JSON imports:
   - JSON files can be imported directly in Vite
   - Type them with type assertions if needed: `import data from './data.json' assert { type: 'json' }`
   - Or create a types file for episode data structure
  </action>
  <verify>
    - `ls src/screens/` shows only .tsx and .css files (no .js)
    - `npx tsc --noEmit` passes with no errors
    - `npm run dev` works and all routes render
  </verify>
  <done>
    - All 6 screen files converted to TypeScript
    - No .js files remain in src/screens/
    - All type errors resolved
  </done>
</task>

<task type="auto">
  <name>Task 3: Convert components and verify full build</name>
  <files>
    src/components/Score.tsx
    src/components/IconButton.tsx
  </files>
  <action>
1. Convert src/components/Score.js to Score.tsx:
   - Type the props interface:
     ```ts
     interface ScoreProps {
       score: number;
       label?: string;
       // ... other props as needed
     }
     ```
   - Type the component: `function Score({ score, label }: ScoreProps)`

2. Convert src/components/IconButton.js to IconButton.tsx:
   - Type the props interface:
     ```ts
     interface IconButtonProps {
       icon: React.ReactNode;
       onClick?: () => void;
       // ... other props
     }
     ```
   - Type event handlers properly

3. Delete the .js files after conversion.

4. Final verification:
   - Run `find src -name "*.js" -type f` to ensure no .js files remain
   - Run `npx tsc --noEmit` to verify zero type errors
   - Run `npm run build` to verify production build succeeds

5. Clean up any remaining issues:
   - Fix any implicit any types
   - Add missing type imports
   - Ensure all exports are properly typed
  </action>
  <verify>
    - `find src -name "*.js" -type f` returns empty (no .js files)
    - `npx tsc --noEmit` exits with code 0 (no errors)
    - `npm run build` succeeds
    - `npm run dev` starts and full app works
  </verify>
  <done>
    - All JavaScript files converted to TypeScript
    - Zero type errors with strict mode
    - Production build succeeds
    - App runs correctly with all routes working
  </done>
</task>

</tasks>

<verification>
1. `find src -name "*.js" -type f` returns nothing (all .js files converted)
2. `npx tsc --noEmit` passes with exit code 0
3. `npm run build` succeeds without errors
4. `npm run dev` starts and navigate through all routes
5. Check a few routes manually: /, /windows, /question/speed
</verification>

<success_criteria>
- Zero .js files in src/ directory
- Zero TypeScript compilation errors
- Strict mode enabled (noImplicitAny, strict: true)
- Production build succeeds
- All existing functionality preserved
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-migration/01-02-SUMMARY.md`
</output>
